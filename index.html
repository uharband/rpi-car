<!DOCTYPE html>
<html>
<body>

<h2>Car Controller</h2>
<button type="button" onclick="carAction('forward')">Forward</button>
<button type="button" onclick="carAction('backward')">Backward</button>
<button type="button" onclick="carAction('right')">Right 90</button>
<button type="button" onclick="carAction('left')">Left 90</button>
<button type="button" onclick="carAction('stop')">Stop</button>
<br/>

<h2>Audio</h2>

<audio id="audio" controls="controls">
	<source id="audioSource" src='http://10.0.0.4:8080'></source>
	Your browser does not support the audio format.
</audio>

<button type="button" onclick="enableVideo(true)">Turn on Video</button>
<button type="button" onclick="enableVideo(false)">Turn off Video</button>
<button onclick="audioAction('play')">play</button>
<button onclick="audioAction('pause')">pause</button>
<button onclick="audioAction('stop')">stop</button>


<br/>
<h2>Video</h2>
<img id='video' src=http://10.0.0.4:8082/ border="0" width=25%/>

<div>
	<button type="button" onclick="enableVideo(true)">Turn on Video</button>
	<button type="button" onclick="enableVideo(false)">Turn off Video</button>
	<br/>
	<br/>
</div>

operation status: <div id="status">
</div>
</br/>
<script>
function enableVideo(enable){
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		console.log('video req returned. state =  ' + this.readyState + ' ' + this.status);
		if (this.readyState == 4 && this.status == 200) {
			var video = document.getElementById('video');
			video.src = 'http://10.0.0.4:8082';
			console.log('before setting');
			document.getElementById("status").innerHTML = this.responseText;
			console.log('after setting');
		}
	};
	if(enable){
		xhttp.open("GET", "/videoon", true);
	}
	else{
		xhttp.open("GET", "/videooff", true);
	}
	xhttp.send();
}

function enableSystem(system, enable){
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		console.log('system= ' + system + ', enable= ' + enable + ' req status changed. state =  ' + this.readyState + ' ' + this.status);
		if (this.readyState == 4 && this.status == 200) {
			switch(syste){
				case 'video':
					if(enable){
						var video = document.getElementById('video');
						video.src = 'http://10.0.0.4:8082';						
						document.getElementById("status").innerHTML = 'started audio';				
					}
					break;
				case 'audio':
					if(enable){
						var video = document.getElementById('video');
						video.src = 'http://10.0.0.4:8082';						
						document.getElementById("status").innerHTML = 'started audio';				
					}				
					break;
			}

		}
	};
	if(enable){
		xhttp.open("GET", "/videoon", true);
	}
	else{
		xhttp.open("GET", "/videooff", true);
	}
	xhttp.send();
}

function audioAction(action){
	var audio = document.getElementById('audio');
	var source = document.getElementById('audioSource');
	alert(action);
	switch(action){
		case 'play':   
		source.src = 'http://10.0.0.4:8080';
		audio.play();
		break;
    case 'puase':
		audio.pause();
		break;
    case 'stop':
		audio.pause();
		audio.source = audio.source;
		break;
	}
}


function carAction(action) {
	document.getElementById("status").innerHTML = "entered " + action;
	var xhttp = new XMLHttpRequest();
	xhttp.onreadystatechange = function() {
		if (this.readyState == 4 && this.status == 200) {
			document.getElementById("status").innerHTML =
			this.responseText;
		}
	};
	switch(action){
		case "forward":
		  xhttp.open("GET", "/forward", true);
		  break;
		case "backward":
		  xhttp.open("GET", "/backward", true);
		  break;
		case "stop":
		  xhttp.open("GET", "/stop", true);
		  break;
		case "right":
		  xhttp.open("GET", "/right/90", true);
		  break;
		case "left":
		  xhttp.open("GET", "/left/90", true);
		  break;
  }
  xhttp.send();
}
</script>

</body>
</html>

